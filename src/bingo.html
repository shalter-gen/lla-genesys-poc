<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SDIP Spotlight Bingo v1</title>
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: #f9f9f9;
            padding: 20px;
            margin: 0;
        }
        h1 {
            text-align: center;
            margin-bottom: 24px;
        }
        .container {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            gap: 40px;
        }
        table {
            border-collapse: collapse;
            font-size: 1.1em;
            background: #fff;
            box-shadow: 0 2px 12px #bbb;
            margin-bottom: 14px;
        }
        th, td {
            border: 1px solid #bbb;
            width: 230px;
            height: 130px;
            text-align: center;
            vertical-align: middle;
            position: relative;
            padding: 0;
        }
        th {
            background: #194470;
            color: #fff;
            font-weight: 600;
            width: 60px;
            height: 40px;
        }
        td {
            background: #e5ecfa;
            cursor: pointer;
            transition: background 0.10s;
            font-size: 1.05em;
        }
        td.revealed {
            background: #b5dafa;
            color: #333;
            cursor: default;
            font-weight: 600;
        }
        .cell-content {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            width: 100%;
            font-size: 1.05em;
            min-height: 50px;
            min-width: 70px;
        }
        .cell-label {
            color: #688ec9;
            font-size: 2em;
            font-weight: 900;
            opacity: 0.20;
            position: absolute;
            bottom: 5px;
            right: 12px;
        }
        #score-panel {
            background: #f0f5fb;
            border: 1px solid #b8dafc;
            border-radius: 8px;
            max-width: 320px;
            box-shadow: 0 2px 6px #aac;
            padding: 24px 20px 28px 20px;
        }
        #score-panel h2 {
            font-size: 1.18em;
            margin: 0 0 12px 0;
            text-align: center;
            color: #345099;
        }
        .score-row {
            display: flex;
            margin-bottom: 6px;
            align-items: center;
            gap: 6px;
            font-size: 1em;
        }
        .score-label {
            width: 50px;
            color: #386ca9;
            font-weight: bold;
        }
        select {
            font-size: 1em;
            padding: 2px;
            min-width: 120px;
            border-radius: 3px;
            border: 1px solid #b4b4b4;
            background: #fff;
        }
        #winner-box {
            background: #e0f6e8;
            border-radius: 6px;
            margin-top: 20px;
            padding: 13px 10px;
            text-align: left;
            min-height: 38px;
            font-size: 1.08em;
            box-shadow: 0 0 8px #c8efc5;
            border: 1px solid #66bb99;
        }
        #reset-btn {
            display: block;
            margin: 18px auto 0 auto;
            background: #dd3e3e;
            color: #fff;
            font-weight: bold;
            border: none;
            border-radius: 6px;
            font-size: 1em;
            padding: 7px 14px;
            cursor: pointer;
            box-shadow: 0 2px 8px #eee;
            transition: background 0.11s;
        }
        #reset-btn:hover {
            background: #aa2400;
        }
        @media (max-width: 1024px) {
            .container {flex-direction: column;}
            #score-panel {margin: 0 auto;}
        }
    </style>
    <script>
        // Bingo Q&A
        const bingoQuestions_v1 = [
            "Has visited a famous shanty town in Cancun.",
            "Has survived zip lining across hills and rivers.",
            "Can list all monarchs and spouses of England/GB from 1066 and share facts about each.",
            "Turned $200 into $12,000 at a casino, then lost it all in one bet.",
            "Has cooked chicken biryani so well it’s become their signature dish.",
            "Was a guest of Celtic FC and flew on their official plane to a Champions League match.",
            "Has run clubs or raves during the 'summer of love' era and found their community.",
            "Grew up in the same town as an actor who played Dr. Who.",
            "Collects Laughing Buddhas, knowing they're modeled after a Chinese monk, not the Buddha.",
            "Enjoys spinning progressive house vinyl on Technics 1210s and loves ‘hole in the wall’ eateries.",
            "Has attended Soundwave Festival 2013.",
            "Is undefeated at Trivial Pursuit.",
            "Was born bald and had her grandmother shave her head 3–4 times to make her hair thicker.",
            "Was part of a school classical music band as a child.",
            "Has mastered making water droplet sounds with their cheek.",
            "Is surprisingly skilled in multiple racquet sports.",
            "Once enrolled themselves in primary school in Australia as a child.",
            "Was a school supervisor for a year after failing the baccalaureate.",
            "Has a Moodle named Lily that isn't even their own dog, but prefers her to most friends and family.",
            "Has played in an orchestra as a child.",
            "Has collected marbles just to play games with friends.",
            "Has experience reverse parking perfectly in one move.",
            "Has been to Westvleteren Monastery in Belgium, open only two weeks a year, famed for its trappist beer.",
            "Can tie knots exceptionally well.",
            "Has a heritage spanning French, Sri Lankan, Mauritian, Welsh, and Spanish backgrounds."
        ];
        const bingoQuestions = [
            "Has driven on a race track and then been shown how it’s really done by a professional racing driver.",
            "Was part of a school classical music band back in the day.",
            "Once flew on the official Celtic FC plane to a Champions League match as a guest.",
            "Can make a water droplet sound using just their cheek.",
            "Spent time running clubs and raves during the ‘summer of love’ and found their community there.",
            "Loves spinning progressive house vinyl on classic Technics 1210 turntables.",
            "Has a fascinating heritage mixing French, Sri Lankan, Mauritian, Welsh, and Spanish roots.",
            "Knows how to tie knots exceptionally well—more than just a sailor’s skill!",
            "Can list every monarch and their spouse of England/Great Britain since 1066, complete with fun facts.",
            "Is undefeated at Trivial Pursuit and ready to defend their title.",
            "Has a Moodle named Lily who isn’t even their dog but easily beats most friends for affection.",
            "Was born bald and had their grandmother shave their head multiple times to encourage thicker hair growth.",
            "Can reverse park perfectly in one smooth move, thanks to some quick coaching.",
            "Has visited the Westvleteren Monastery in Belgium, open only two weeks per year and famous for its trappist beer.",
            "Has braved zip lining over hills and rivers with great thrill.",
            "Attended the iconic Soundwave Festival in 2013.",
            "Played in an orchestra as a child, bringing music to life.",
            "Explored a famous shanty town in Cancun — a truly unusual place.",
            "Worked as a school supervisor for a year after failing their baccalaureate exams.",
            "Collected marbles as a kid, but only because it meant more playtime with friends.",
            "Turned $200 into $12,000 at a casino once, before losing it all on one daring bet.",
            "Has mastered cooking chicken biryani so well it’s their signature dish when hosting.",
            "Collects Laughing Buddhas, fully understanding they’re based on a Chinese Buddhist monk, not the historical Buddha.",
            "Is surprisingly good at multiple racquet sports, from badminton to tennis.",
            "Enrolled themselves in primary school in Australia — all on their own!"
        ];
        const COLS = 5, ROWS = 5;
        const labelsHorizontal = ["A", "B", "C", "D", "E"];
        let cellLabels = [];
        for (let r = 0; r < ROWS; r++) {
            for (let c = 0; c < COLS; c++) {
                cellLabels.push(labelsHorizontal[c] + '-' + (r + 1));
            }
        }
        const participants = [
            "James","Satish","Thierry","Paul","Varun","Ruth","Deepti","Louise","Malita","Stephen","Mark","Ben","Dominic","Jeremy"
        ];

        // State management
        function getSavedGame() {
            // { openCells: [bool, ...], scores: [name,...] }
            try {
                let raw = localStorage.getItem('bingoGameState');
                if (!raw) return null;
                let obj = JSON.parse(raw);
                if (!obj.openCells || !obj.scores || obj.openCells.length !== 25 || obj.scores.length !== 25) return null;
                return obj;
            } catch {
                return null;
            }
        }
        function saveGameState(open, scores) {
            try {
                localStorage.setItem('bingoGameState', JSON.stringify({openCells: open, scores: scores}));
            } catch {}
        }
        function resetGameState() {
            localStorage.removeItem('bingoGameState');
        }

        document.addEventListener("DOMContentLoaded", function () {

            window.updateWinnerBox = function () {
                let counts = {};
                for (let p of participants) counts[p] = 0;
                for (let i = 0; i < 25; i++) {
                    let val = scores[i];
                    if (val && participants.includes(val)) counts[val]++;
                }
                let max = 0, champs = [];
                for (let p of participants) {
                    if (counts[p] > max) max = counts[p];
                }
                for (let p of participants) {
                    if (counts[p] === max && max > 0) champs.push(p);
                }
                let out = '';
                if (max === 0) {
                    out = "<b>No answers scored yet.</b>";
                } else {
                    out = `<b>Winner${champs.length>1?'s':''}:</b> &nbsp; ${champs.join(', ')}<br>`;
                    out += "<b>Score:</b> " + max + "<br>";
                }
                out += "<br><u>Live Tally:</u><br>";
                out += participants.map(p => `${p}: <b>${counts[p]}</b>`).join(" &nbsp; ");
                document.getElementById("winner-box").innerHTML = out;
            }

            window.revealCell = function (id, idx) {
                let td = document.getElementById(id);
                if (openCells[idx]) return;
                td.classList.add("revealed");
                let q = td.querySelector(".cell-question");
                q.style.display = "inline";
                let label = td.querySelector(".cell-label");
                label.style.opacity = 0.10;
                openCells[idx] = true;
                saveGameState(openCells, scores);
            }
            

            let saved = getSavedGame();
            let openCells = saved ? saved.openCells.slice() : Array(25).fill(false);
            let scores = saved ? saved.scores.slice() : Array(25).fill("");
            // BINGO table
            let tableHTML = "<table>";
            tableHTML += "<tr><th></th>";
            for (let c = 0; c < COLS; c++)
                tableHTML += `<th>${labelsHorizontal[c]}</th>`;
            tableHTML += "</tr>";
            let idx = 0;
            for (let r = 0; r < ROWS; r++) {
                tableHTML += `<tr><th>${r + 1}</th>`;
                for (let c = 0; c < COLS; c++) {
                    let cellId = `cell-${r}-${c}`;
                    let cellLabel = labelsHorizontal[c] + '-' + (r + 1);
                    // revealed if openCells[idx]
                    tableHTML += `
                        <td id="${cellId}" class="${openCells[idx] ? 'revealed':''}" onclick="revealCell('${cellId}',${idx})">
                            <div class="cell-content">
                                <span class="cell-label" style="opacity:${openCells[idx]?0.10:0.20}">${cellLabel}</span>
                                <span class="cell-question" style="display:${openCells[idx]?'inline':'none'}">${bingoQuestions[idx]}</span>
                            </div>
                        </td>
                    `;
                    idx++;
                }
                tableHTML += "</tr>";
            }
            tableHTML += "</table>";
            document.getElementById("bingo-table-container").innerHTML = tableHTML;

            // Score Panel
            let scoreHTML = `<h2>Scoring Panel</h2>`;
            for (let i = 0; i < 25; i++) {
                scoreHTML += `<div class="score-row">
                    <div class="score-label">${cellLabels[i]}</div>
                    <select onchange="onScoreSelect(${i})" id="score-q${i}">
                    <option value="">---</option>
                    ${participants.map(name => `<option value="${name}">${name}</option>`).join('')}
                    </select>
                </div>`;
            }
            scoreHTML += '<div id="winner-box"></div>';
            scoreHTML += `<button id="reset-btn" onclick="resetBingoGame()">Reset Game</button>`;
            document.getElementById("score-panel").innerHTML = scoreHTML;
            // Restore scores to UI
            for (let i = 0; i < 25; i++) {
                document.getElementById('score-q'+i).value = scores[i];
            }
            updateWinnerBox();

            // Expose functions globally
            window.onScoreSelect = function(idx) {
                let val = document.getElementById('score-q'+idx).value;
                scores[idx] = val;
                saveGameState(openCells, scores);
                updateWinnerBox();
            }
            window.resetBingoGame = function() {
                if (!window.confirm("Reset all progress, scores, and open questions?")) return;
                // Reset
                openCells = Array(25).fill(false);
                scores = Array(25).fill("");
                resetGameState();
                // Hide all cell questions
                for (let r = 0; r < ROWS; r++) {
                    for (let c = 0; c < COLS; c++) {
                        let idx = r * COLS + c;
                        let cellId = `cell-${r}-${c}`;
                        let td = document.getElementById(cellId);
                        td.classList.remove("revealed");
                        let qSpan = td.querySelector(".cell-question");
                        qSpan.style.display = "none";
                        let labelSpan = td.querySelector(".cell-label");
                        labelSpan.style.opacity = 0.20;
                    }
                }
                // Reset all select boxes
                for (let i = 0; i < 25; i++) {
                    document.getElementById('score-q'+i).value = "";
                }
                updateWinnerBox();
            }
        });
    </script>
</head>
<body>
    <h1>Spotlight Bingo</h1>
    <div class="container">
        <div id="bingo-table-container"></div>
        <div id="score-panel"></div>
    </div>
    <div style="text-align:center; margin-top:24px; color:#444;">
        Each player: pick a grid cell (e.g., <b>C-2</b>), click to reveal your question.<br>
        When someone answers correctly, the host marks the winner for that question in the score panel.<br>
        Progress and scores are automatically saved and restored — use "Reset" for a fresh game.
    </div>
</body>
</html>
